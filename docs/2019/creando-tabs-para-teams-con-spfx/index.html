<!DOCTYPE html>
<html lang="es-es">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Creando Tabs Para Teams Con Spfx | Ruben Ramos blog</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Creando Tabs Para Teams Con Spfx">
    <meta name="generator" content="Hugo 0.80.0" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="https://rubenrm.com/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css" rel="stylesheet">
    

    

    
      

    

    
    
    <meta property="og:title" content="Creando Tabs Para Teams Con Spfx" />
<meta property="og:description" content="Creando Tabs Para Teams Con Spfx" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rubenrm.com/2019/creando-tabs-para-teams-con-spfx/" />
<meta property="article:published_time" content="2019-05-16T00:00:00+01:00" />
<meta property="article:modified_time" content="2019-05-16T00:00:00+01:00" />
<meta itemprop="name" content="Creando Tabs Para Teams Con Spfx">
<meta itemprop="description" content="Creando Tabs Para Teams Con Spfx">
<meta itemprop="datePublished" content="2019-05-16T00:00:00+01:00" />
<meta itemprop="dateModified" content="2019-05-16T00:00:00+01:00" />
<meta itemprop="wordCount" content="1043">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Creando Tabs Para Teams Con Spfx"/>
<meta name="twitter:description" content="Creando Tabs Para Teams Con Spfx"/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  
  
  <header class="cover bg-top" style="background-image: url('https://rubenrm.com/images/MSTeams.png');">
    <div class="pb3-m pb6-l bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://rubenrm.com/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Ruben Ramos blog
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://rubenrm.com/posts/" title="Posts page">
              Posts
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://rubenrm.com/events" title="Eventos page">
              Eventos
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://rubenrm.com/categories/" title="Categorias page">
              Categorias
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://rubenrm.com/about" title="Sobre mi page">
              Sobre mi
            </a>
          </li>
          
        </ul>
      
      















    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Creando Tabs Para Teams Con Spfx</h1>
          
            <h2 class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
              Creando Tabs Para Teams Con Spfx
            </h2>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        POSTS
      </aside>
      




  <div id="sharing" class="mt3">

    
    <a href="https://www.facebook.com/sharer.php?u=https://rubenrm.com/2019/creando-tabs-para-teams-con-spfx/" class="facebook no-underline" aria-label="share on Facebook">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

    </a>

    
    
    <a href="https://twitter.com/share?url=https://rubenrm.com/2019/creando-tabs-para-teams-con-spfx/&amp;text=Creando%20Tabs%20Para%20Teams%20Con%20Spfx" class="twitter no-underline" aria-label="share on Twitter">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

    </a>

    
    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://rubenrm.com/2019/creando-tabs-para-teams-con-spfx/&amp;title=Creando%20Tabs%20Para%20Teams%20Con%20Spfx" class="linkedin no-underline" aria-label="share on LinkedIn">
      <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

    </a>
  </div>


      <h1 class="f1 athelas mt3 mb1">Creando Tabs Para Teams Con Spfx</h1>
      
      <p class="tracked">
          By <strong>
          
              Ruben Ramos
          
          </strong>
      </p>
      
      
      <time class="f6 mv4 dib tracked" datetime="2019-05-16T00:00:00+01:00">May 16, 2019</time>

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>Desde la versión 1.8 de SharePoint Framework se pueden implementar pestañas para Teams con SPFx. Con esto podemos conseguir 2 cosas:</p>
<ul>
<li>Vamos a poder reutilizar nuestros desarrollos SPFx para utilizar tanto en SharePoint Online como en Teams</li>
<li>Los desarrollos que hagamos con SharePoint Framework se hospedan automáticamente en SharePoint y no necesitaremos de servicios externos para hospedar nuestra aplicación.</li>
</ul>
<h2 id="creando-nuestro-primer-proyecto">Creando nuestro primer proyecto</h2>
<p>El proceso de creación del proyecto de nuestra primera pestaña con SPFx es igual que si hiciésemos un webpart SPFx para SharePoint Online.</p>
<p>Dentro del directorio de nuestra solución, ejecutamos el generador de Yeoman para Sharepoint.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">yo @microsoft/sharepoint
</code></pre></div><p>Cuando configuramos el proyecto hay algunas cosas que tenemos que tener en cuenta:</p>
<ol>
<li>Debemos seleccionar que nuestra solución la queremos implementar en “Solo SharePoint Online (más reciente)”</li>
<li>Cuando nos pregunte si queremos desplegar automáticamente en todo el tenant le diremos que si, de esta forma no será necesario instalar la aplicación en la colección de sitios antes de utilizarla.</li>
<li>Indicaremos que queremos crear un WebPart</li>
</ol>
<p><img src="https://rubenrm.com/images/creando-tabs-para-teams-con-spfx-01.png" alt="Opciones yo teams"></p>
<h2 id="que-nos-encontramos-cuando-se-crea-el-proyecto">¿Que nos encontramos cuando se crea el proyecto?</h2>
<p>Una vez terminado el proceso de creación de la solución, veremos que se nos ha creado una estructura de carpetas muy parecida a la que tenemos cuando creamos cualquier webpart SPFx.</p>
<p><img src="https://rubenrm.com/images/creando-tabs-para-teams-con-spfx-02.png" alt="Estructura de carpetas"></p>
<p>Si nos fijamos, verenemos que dentro del directorio de la solución se ha creado una carpeta Teams que incluye 2 imagenes con iconos, estos iconos son los que se incluirán del paquete de la aplicación y son los mismos de los que hablamos en el post Un vistazo al Teams app package</p>
<h2 id="actualiza-el-manifiesto-del-webpart-para-que-esté-disponible-para-microsoft-teams">Actualiza el manifiesto del WebPart para que esté disponible para Microsoft Teams</h2>
<p>Cuando creamos el webpart, únicamente estará disponible como un webpart de SharePoint Online. Para que nuestra solución esté disponible en Teams tenemos que modificar el manifiesto del webpart que se encuentra dentro de la carpeta con el código de nuestro webpart. Dentro del manifiesto debemos modificar el nodo supportedHosts para indicar que también queremos utilizar nuestro webpart como una pestaña de Teams.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#e6db74">&#34;supportedHosts&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> [<span style="color:#e6db74">&#34;SharePointWebPart&#34;</span>, <span style="color:#e6db74">&#34;TeamsTab&#34;</span>]<span style="color:#960050;background-color:#1e0010">,</span>
</code></pre></div><h2 id="estoy-en-sharepoint-o-en-teams">¿Estoy en SharePoint o en Teams?</h2>
<p>En ocasiones tendremos que identificar si nuestro webpart SPFx se está ejecutando dentro de Teams o en SharePoint. Para poder hacer esto vamos a modificar nuestro webpart para que obtenga el contexto de Teams.</p>
<ol>
<li>Abrimos el fichero src\webparts\helloWorld\HelloWorldWebPart.ts e incluimos la instrucción</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">import</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">as</span> <span style="color:#a6e22e">microsoftTeams</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@microsoft/teams-js&#39;</span>;
</code></pre></div><ol>
<li>Creamos una propiedad en el webpart que contenga el contexto de Teams</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">private</span> <span style="color:#a6e22e">_teamsContext</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">microsoftTeams</span>.<span style="color:#a6e22e">Context</span>;
</code></pre></div><ol start="3">
<li>Añadimos un metodo onInit en nuestro webpart para obtener el contexto</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">protected</span> <span style="color:#a6e22e">onInit</span>()<span style="color:#f92672">:</span> Promise<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">any</span><span style="color:#f92672">&gt;</span> {
   <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">retVal</span><span style="color:#f92672">:</span> Promise<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">any</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">=</span> Promise.<span style="color:#a6e22e">resolve</span>();
   <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">microsoftTeams</span>) {
      <span style="color:#a6e22e">retVal</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Promise((<span style="color:#a6e22e">resolve</span>, <span style="color:#a6e22e">reject</span>) =&gt; {
         <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">microsoftTeams</span>.<span style="color:#a6e22e">getContext</span>(<span style="color:#a6e22e">context</span> =&gt; {
            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_teamsContext</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">context</span>;
            <span style="color:#a6e22e">resolve</span>();
         });
      });
   }
   <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">retVal</span>;
}
</code></pre></div><ol start="4">
<li>Como hemos creado nuestro webpart utilizando React, vamos a pasar el contexto como una propiedad del componente. Incluimos la propiedad dentro del fichero src\webparts\helloWorld\components\IHelloWorldProps.ts</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">import</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">as</span> <span style="color:#a6e22e">microsoftTeams</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@microsoft/teams-js&#39;</span>;
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IHelloWorldProps</span> {
    <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">string</span>;
    <span style="color:#a6e22e">teamsContext</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">microsoftTeams</span>.<span style="color:#a6e22e">Context</span>
}
</code></pre></div><ol start="5">
<li>Dentro del método Render de nuestro webpart, le pasamos la propiedad</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">public</span> <span style="color:#a6e22e">render</span>()<span style="color:#f92672">:</span> <span style="color:#66d9ef">void</span> {
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">element</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">ReactElement</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">IHelloWorldProps</span> <span style="color:#f92672">&gt;</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">createElement</span>(
<span style="color:#a6e22e">HelloWorld</span>,
{
<span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">description</span>,
<span style="color:#a6e22e">teamsContext</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_teamsContext</span>
}
);
<span style="color:#a6e22e">ReactDom</span>.<span style="color:#a6e22e">render</span>(<span style="color:#a6e22e">element</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">domElement</span>);
}
</code></pre></div><ol start="6">
<li>Ahora dentro de nuestro componente podemos utilizar el contexto que recibimos para identificar si estamos en Teams o no</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">title</span>, <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span><span style="color:#a6e22e">string</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
<span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">props</span>.<span style="color:#a6e22e">teamsContext</span>) {
<span style="color:#a6e22e">title</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Welcome to Teams!&#39;</span>;
<span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Customize Teams experiences using Tabs.&#39;</span>;
}
<span style="color:#66d9ef">else</span> {
<span style="color:#a6e22e">title</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Welcome to SharePoint!&#39;</span>;
<span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Customize SharePoint experiences using Web Parts.&#39;</span>;
}
</code></pre></div><h2 id="desplegando-la-aplicación-en-sharepoint">Desplegando la aplicación en SharePoint</h2>
<p>Para desplegar nuestra aplicación en SharePoint lo haremos exactamente igual que con cualquier webpart que hayamos creado con SPFx.</p>
<p>Generamos el paquete de la solución:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">gulp build
gulp bundle <span style="color:#960050;background-color:#1e0010">–</span>ship
gulp package-solution --ship
</code></pre></div><p>Desplegamos el paquete en el catálogo de aplicaciones, marcando que la solución estará disponible en todo el tenant.</p>
<p><img src="https://rubenrm.com/images/creando-tabs-para-teams-con-spfx-03.png" alt="Desplegando webparta en el catálogo de aplicaciones"></p>
<p>Una vez desplegado la solución, insertamos el webpart en una página y vemos el resultado.</p>
<p><img src="https://rubenrm.com/images/creando-tabs-para-teams-con-spfx-04.png" alt="Imagen del webpart"></p>
<p>Como podemos ver, ha detectado que está en el contexto de SharePoint y nos muestra el mensaje que hemos añadido cuando se encuentra en SharePoint.</p>
<h2 id="añade-la-pestaña-en-teams">Añade la pestaña en Teams</h2>
<p>Ahora toca la parte más manual, pero por ahora. Microsoft está trabajando para que podamos sincronizar las aplicaciones que despleguemos en el catálogo de aplicaciones de SharePoint con Teams, de hecho, si vamos al catálogo de aplicaciones podemos ver el botón para hacerlo, pero por ahora está inactivo.</p>
<p><img src="https://rubenrm.com/images/creando-tabs-para-teams-con-spfx-05.png" alt="Sincronizar aplicacion con Teams"></p>
<p>Hasta que no esté activo nos tocará hacerlo “a mano”.</p>
<p>Lo primero que tenemos que hacer es crear un archivo con el manifiesto de la aplicación de Teams, para ello vete a la carpeta de teams y crea un fichero manifest.json. Dentro de ese fichero puedes utilizar esta plantilla:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">
{
   <span style="color:#f92672">&#34;$schema&#34;</span>: <span style="color:#e6db74">&#34;https://developer.microsoft.com/en-us/json-schemas/teams/v1.2/MicrosoftTeams.schema.json&#34;</span>,
   <span style="color:#f92672">&#34;manifestVersion&#34;</span>: <span style="color:#e6db74">&#34;1.2&#34;</span>,
   <span style="color:#f92672">&#34;packageName&#34;</span>: <span style="color:#e6db74">&#34;{{SPFX_COMPONENT_ALIAS}}&#34;</span>,
   <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;aa3fecf0-1fd0-4751-aba1-12314dc3a22f&#34;</span>,
   <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;0.1&#34;</span>,
   <span style="color:#f92672">&#34;developer&#34;</span>: {
     <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Super Developer&#34;</span>,
     <span style="color:#f92672">&#34;websiteUrl&#34;</span>: <span style="color:#e6db74">&#34;https://products.office.com/en-us/sharepoint/collaboration&#34;</span>,
     <span style="color:#f92672">&#34;privacyUrl&#34;</span>: <span style="color:#e6db74">&#34;https://privacy.microsoft.com/en-us/privacystatement&#34;</span>,
     <span style="color:#f92672">&#34;termsOfUseUrl&#34;</span>: <span style="color:#e6db74">&#34;https://www.microsoft.com/en-us/servicesagreement&#34;</span>
   },
   <span style="color:#f92672">&#34;name&#34;</span>: {
     <span style="color:#f92672">&#34;short&#34;</span>: <span style="color:#e6db74">&#34;{{SPFX_COMPONENT_NAME}}&#34;</span>
   },
   <span style="color:#f92672">&#34;description&#34;</span>: {
     <span style="color:#f92672">&#34;short&#34;</span>: <span style="color:#e6db74">&#34;{{SPFX_COMPONENT_SHORT_DESCRIPTION}}&#34;</span>,
     <span style="color:#f92672">&#34;full&#34;</span>: <span style="color:#e6db74">&#34;{{SPFX_COMPONENT_LONG_DESCRIPTION}}&#34;</span>
   },
   <span style="color:#f92672">&#34;icons&#34;</span>: {
     <span style="color:#f92672">&#34;outline&#34;</span>: <span style="color:#e6db74">&#34;{{SPFX_COMPONENT_ID}}_outline.png&#34;</span>,
     <span style="color:#f92672">&#34;color&#34;</span>: <span style="color:#e6db74">&#34;{{SPFX_COMPONENT_ID}}_color.png&#34;</span>
   },
   <span style="color:#f92672">&#34;accentColor&#34;</span>: <span style="color:#e6db74">&#34;#004578&#34;</span>,
   <span style="color:#f92672">&#34;configurableTabs&#34;</span>: [
     {
       <span style="color:#f92672">&#34;configurationUrl&#34;</span>: <span style="color:#e6db74">&#34;https://{teamSiteDomain}{teamSitePath}/_layouts/15/TeamsLogon.aspx?SPFX=true&amp;dest={teamSitePath}/_layouts/15/teamshostedapp.aspx%3FopenPropertyPane=true%26teams%26componentId={{SPFX_COMPONENT_ID}}%26forceLocale={locale}&#34;</span>,
       <span style="color:#f92672">&#34;canUpdateConfiguration&#34;</span>: <span style="color:#66d9ef">true</span>,
       <span style="color:#f92672">&#34;scopes&#34;</span>: [
         <span style="color:#e6db74">&#34;team&#34;</span>
       ]
     }
   ],
   <span style="color:#f92672">&#34;validDomains&#34;</span>: [
     <span style="color:#e6db74">&#34;*.login.microsoftonline.com&#34;</span>,
     <span style="color:#e6db74">&#34;*.sharepoint.com&#34;</span>,
     <span style="color:#e6db74">&#34;*.sharepoint-df.com&#34;</span>,
     <span style="color:#e6db74">&#34;spoppe-a.akamaihd.net&#34;</span>,
     <span style="color:#e6db74">&#34;spoprod-a.akamaihd.net&#34;</span>,
     <span style="color:#e6db74">&#34;resourceseng.blob.core.windows.net&#34;</span>,
     <span style="color:#e6db74">&#34;msft.spoppe.com&#34;</span>
   ],
   <span style="color:#f92672">&#34;webApplicationInfo&#34;</span>: {
     <span style="color:#f92672">&#34;resource&#34;</span>: <span style="color:#e6db74">&#34;https://{teamSiteDomain}&#34;</span>,
     <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;00000003-0000-0ff1-ce00-000000000000&#34;</span>
   }
}

</code></pre></div><p>Ahora tienes que actualizar los siguientes valores en el manifiesto con los valores de tu webpart:</p>
<p>manifest.json	| webpart SPFx
{{SPFX_COMPONENT_ALIAS}}	| alias
{{SPFX_COMPONENT_NAME}}	| preconfiguredEntries[0].title
{{SPFX_COMPONENT_SHORT_DESCRIPTION}}	| preconfiguredEntries[0].description
{{SPFX_COMPONENT_LONG_DESCRIPTION}}	| preconfiguredEntries[0].description
{{SPFX_COMPONENT_ID}}	| id</p>
<p>Una vez creado el manifiesto tenemos que crear un zip con el contenido de la carpeta teams, es decir, el zip contendrá el fichero manifest.json que acabamos de crear y las dos imagenes con los iconos de nuestra app.</p>
<p>Para subir la app a Teams haremos igual que cuando creamos una pestaña con NodeJS, en el post anterior.</p>
<p>Dentro de las opciones del team vamos a Administrar equipo</p>
<p><img src="https://rubenrm.com/images/creando-tabs-para-teams-con-spfx-06.png" alt="Administrar equipo en Teams"></p>
<p>Dentro de la pestaña de Aplicaciones pulsamos el enlace Cargar una aplicación personalizada que se encuentra en la zona inferior derecha y seleccionamos el zip que hemos generado dentro de la carpeta package de nuestra solución</p>
<p><img src="https://rubenrm.com/images/creando-tabs-para-teams-con-spfx-07.png" alt="Cargar aplicación personalizada"></p>
<p>Con esto ya tendríamos disponible nuestra app, pero aún nos queda añadir la ficha en nuestro team, como si fuese cualquier otra ficha. Vamos al canal general –&gt; Añadir ficha</p>
<p><img src="https://rubenrm.com/images/creando-tabs-para-teams-con-spfx-08.png" alt="Añadir pestaña en Teams"></p>
<p>Buscamos la ficha que hemos creado y la seleccionamos y al guardar veremos nuestro webpart SPFx en Teams y vemos que nos ha detectado el contexto de Teams</p>
<p><img src="https://rubenrm.com/images/creando-tabs-para-teams-con-spfx-09.png" alt="Resultado del webpart en Teams"></p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://rubenrm.com/" >
    &copy;  Copyright &copy; 2021 - Ruben Ramos 2021 
  </a>
    <div>














</div>
  </div>
</footer>

    

  <script src="https://rubenrm.com/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
